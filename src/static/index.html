<!doctype html>
<html>
<head>
	<title>rubbrl4zr</title>
    <link rel="stylesheet" href="style.css" />
    <script type="application/javascript" src="game.js"></script>
</head>
<body>
    <div id="nebula"></div>
    <div class="wrapper">
        <div class="configuration">
            <h2>
                rubbrl4zr
            </h2>

            <div>
                <canvas id="preview" height="400"></canvas>
            </div>
            <label for="slider">Blubb</label>
            <input id="slider" type="range" min="0" max="100" step="1" />

            <input id="slider-value" type="text" value="50" disabled>

            <br />


            <input type="radio" id="sin" name="Zahlmethode" value="SIN" checked>
            <label for="sin">SIN</label>


            <input type="radio" id="cos" name="Zahlmethode" value="COS">
            <label for="cos">COS</label>

            <div class="ready-box">
                <button class="btn rdy-btn">Ready!</button>
                29s
                <br />
                <span>0/4 Players are ready</span>
            </div>
        </div>

        <canvas id="game">
            Gamefield should be here
        </canvas>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function(event) {
            addSliderInput();
            //drawSinus();
			drawPreview();
        });

        const addSliderInput = () => {
            document.getElementById("slider").addEventListener("change", function(e) {
                let val = e.target.value;
                document.getElementById("slider-value").value = val;
            });
        };

        const drawSinus = () => {
            var c = document.getElementById("preview");
            var ctx = c.getContext("2d");
            var i;
            for(i=0; i<360; i+= 20){
                ctx.moveTo(i+5,180);
                ctx.lineTo(i,180);

            }
            ctx.stroke();

            var counter = 0, x=0,y=180;


            //100 iterations
            var increase = 90/180*Math.PI / 9;
            for(i=0; i<=360; i+=10){

                ctx.moveTo(x,y);
                x = i;
                y =  180 - Math.sin(counter) * 120;
                counter += increase;

                ctx.lineTo(x,y);
                ctx.stroke();
                //alert( " x : " + x + " y : " + y + " increase : " + counter ) ;

            }
        }



		let xAxis, yAxis,context,height,width;
		height = 200;
		width = 400;
		const drawPreview = ()=> {
			init({height: height, canvasname: "preview", width:width})
		}




		/**
		 * Init function.
		 *
		 * Initialize variables and begin the animation.
		 */
		const init = ({height, width, canvasname}) => {

			var canvas,
			canvas = document.getElementById(canvasname);

			canvas.width = width;
			canvas.height = height;

			context = canvas.getContext("2d");
			context.font = '18px sans-serif';
			context.strokeStyle = '#000';
			context.lineJoin = 'round';

			height = canvas.height;
			width = canvas.width;

			xAxis = Math.floor(height/2);
			yAxis = Math.floor(width/4);
			xAxis = 0;
			//yAxis = 0;



			context.save();
			draw();
		}

		var test = 0;
		/**
		 * Draw animation function.
		 *
		 * This function draws one frame of the animation, waits 20ms, and then calls
		 * itself again.
		 */
		const draw =  ()=> {

			// Clear the canvas
			context.clearRect(0, 0, width, height);

			// Draw the axes in their own path
			context.beginPath();
			context.stroke();

			// Set styles for animated graphics
			context.save();
			context.strokeStyle = '#00f';
			context.fillStyle = '#fff';
			context.lineWidth = 2;

			// Draw the sine curve at time draw.t, as well as the circle.
			context.beginPath();
			test = (test + 20) % width;
			drawSine(0,test);

			context.stroke();



			// Restore original styles
			context.restore();


			// Update the time and draw again
			//draw.seconds = draw.seconds - .007;
			//draw.t = draw.seconds*Math.PI;

			setTimeout(draw, 55);
		};


		/**
		 * Function to draw sine
		 *
		 * The sine curve is drawn in 10px segments starting at the origin.
		 */
		const drawSine = (t,max)=> {

			let unit = 60;
			// Set the initial x and y, starting at 0,0 and translating to the origin on
			// the canvas.
			var x = 0;
			var y = Math.sin(x);
			context.moveTo(xAxis, unit*y+yAxis);

			// Loop to draw segments
			for (i = xAxis; i <= max; i += 10) {
				x = (-xAxis+i)/unit;
				y = Math.sin(x);
				context.lineTo(i, unit*y+yAxis);
				context.stroke();

			}
		}

        var game = new Game(document.getElementById("game"), []);
        game.addPlayer(new Player(42, "Carsten", new Renderable("img/ship-red.png", new Vector(100,100))))
        game.run();
	</script>
</body>
</html>
